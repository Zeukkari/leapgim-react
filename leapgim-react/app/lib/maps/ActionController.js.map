{"version":3,"sources":["ActionController.coffee"],"names":[],"mappings":"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","file":"ActionController.js","sourceRoot":"/source/","sourcesContent":["#\n# Action Controller\n#\n# Triggers mouse and keyboard actions based on configured recipes. Actions are idempotent operations.\n#\n# execSh = require 'exec-sh'\n# window.robot = require 'robotjs'\nexecSh = nativeRequire 'exec-sh'\nwindow.robot = nativeRequire 'robotjs'\n\nfeedback = window.feedback\nconfig = window.config\n\n\nclass ActionController\n    constructor: ->\n        @actions = window.config.actions\n        @recipes = window.config.recipes\n        @robot = window.robot\n        @mouseState = 'free' # free|frozen\n        @position =\n            x: 0\n            y: 0\n        @freezePosition =\n            x: 0\n            y: 0\n        @unfreezePosition =\n            x: 0\n            y: 0\n        @keyboardModel =\n            test: false\n        @recipeState = {}\n        for name, recipe of @recipes\n            @recipeState[name] =\n                status: 'inactive'\n                timerID: null\n            if(recipe.tearDownDelay)\n                @recipeState[name].tearDownDelay = recipe.tearDownDelay\n\n    freezeMouse: (handPosition) =>\n        @freezePosition = @robot.getMousePos()\n        @mouseState = 'frozen'\n\n    unfreezeMouse: (handPosition) =>\n        screenSize = @robot.getScreenSize()\n        normalizedHandPosition =\n            x: handPosition.x * screenSize.width\n            y: handPosition.y * screenSize.height\n        @unfreezePosition = normalizedHandPosition\n        console.log \"Unfreeze mouse\", @unfreezePosition\n        @mouseState = 'free'\n\n    toggleMouseFreeze: (handPosition) =>\n        if (@mouseState == 'frozen')\n            @unfreezeMouse handPosition\n        else if(@mouseState == 'free')\n            @freezeMouse handPosition\n\n    mouseMove: (handPosition) =>\n        if(@mouseState == 'free')\n            screenSize = @robot.getScreenSize()\n            normalizedHandPosition =\n                x: handPosition.x * screenSize.width\n                y: handPosition.y * screenSize.height\n            offsetMapping =\n                x: @freezePosition.x - @unfreezePosition.x\n                y: @freezePosition.y - @unfreezePosition.y\n            moveTo =\n                x: normalizedHandPosition.x + offsetMapping.x\n                y: normalizedHandPosition.y + offsetMapping.y\n            @robot.moveMouse(moveTo.x, moveTo.y)\n\n    # buttonAction: up|down|click|doubleClick, button: left|right\n    mouseButton: (buttonAction, button) =>\n        feedback = window.feedback\n        if(buttonAction == 'up')\n            @robot.mouseToggle buttonAction, button\n        else if(buttonAction == 'down')\n            @robot.mouseToggle buttonAction, button\n        else if(buttonAction == 'click')\n            @robot.mouseClick button, false\n        else if(buttonAction == 'doubleClick')\n            @robot.mouseClick button, true\n\n    # action: up|down|tap\n    keyboard: (action, button) =>\n        feedback = window.feedback\n        if(action == 'up')\n            @robot.keyToggle button, action\n        else if(action == 'down')\n            @robot.keyToggle button, action\n        else if(action == 'tap')\n            @robot.keyTap button\n        return\n\n    scrollMouse: (direction, magnitude) =>\n        if(direction == 'up' or direction == 'down')\n            @robot.scrollMouse(magnitude, direction)\n        else\n            console.log 'This aint 3d, man!'\n\n\n    delayMouse: (delay) =>\n            @robot.delayMouse(delay)\n\n    execSh: (cmd, options, callback) =>\n        execSh cmd, options, callback\n\n    loadProfile: (profile) ->\n        console.log \"Load profile #{profile}\"\n        window.loadProfile(profile)\n\n\n    executeAction: (action) =>\n        cmd = @actions[action]\n        # console.log \"cmd: \", cmd\n        screenSize = @robot.getScreenSize()\n        if(cmd.feedback?)\n            if(cmd.feedback.audio?)\n                window.feedback.audioNotification cmd.feedback.audio\n            if(cmd.feedback.visual?)\n                options = cmd.feedback.visual\n                window.feedback.visualNotification options.id, options.msg\n\n        if(cmd.type == 'mouse')\n            if(cmd.action == 'freeze')\n                @freezeMouse(@position)\n            if(cmd.action == 'unfreeze')\n                @unfreezeMouse(@position)\n            if(cmd.action == 'toggleFreeze')\n                @toggleMouseFreeze(@position)\n            if(cmd.action in ['up', 'down', 'click', 'doubleClick'])\n                @mouseButton cmd.action, cmd.target\n            if(cmd.action == 'move')\n                @mouseMove(@position)\n            if(cmd.action == 'scroll')\n                @scrollMouse cmd.direction, cmd.magnitude\n            if(cmd.action == 'delay')\n                @delayMouse cmd.delay\n        if(cmd.type == 'keyboard')\n            if(cmd.action in ['up', 'down', 'tap'])\n                @keyboard cmd.action, cmd.button\n        if(cmd.type == 'compound')\n            @executeAction action for action in cmd.actions\n        if(cmd.type == 'exec')\n            @execSh cmd.cmd, cmd.options, (err)->\n                if(err)\n                    console.log \"Exec error\", err\n        if(cmd.type == 'profile')\n            if(cmd.action == 'load')\n                @loadProfile(cmd.target)\n\n    activateRecipe: (recipeName) =>\n        recipe = @recipes[recipeName]\n        #console.log \"recipe data:\", recipe\n        actionName = recipe.action\n\n        # Skip activation if charging\n        if(!@recipeState[recipeName].timerID)\n            if(recipe.continuous)\n                if(@recipeState[recipeName].status != 'sleeping')\n                    if(recipe.chargeDelay)\n                        chargeDelay = recipe.chargeDelay\n                        #console.log \"Recipe #{recipeName} sleeping for #{chargeDelay}\"\n                        callback = () =>\n                            #console.log \"Recipe #{recipeName} is awake!\"\n                            @recipeState[recipeName].status = 'inactive'\n                            @recipeState[recipeName].timerID = null\n                        @recipeState[recipeName].status = 'sleeping'\n                        @recipeState[recipeName].timerID = setTimeout callback, chargeDelay\n                    #console.log \"activate continuous recipe: \", recipeName\n                    @executeAction(actionName)\n                    return true\n                else\n                    #console.log \"Recipe #{recipeName} is sleeping...\"\n                    return false\n            else if(@recipeState[recipeName].status == 'inactive')\n                if(!@recipeState[recipeName].timerID)\n                    #console.log \"Activate recipe #{recipeName}\"\n                    @recipeState[recipeName].status = 'active'\n                    @executeAction(actionName)\n                    return true\n        return false\n\n    tearDownRecipe: (recipeName) =>\n        recipe = @recipes[recipeName]\n        return unless recipe\n        actionName = recipe.tearDown\n\n        # Apathy!\n        if(!actionName)\n            @recipeState[recipeName].status = 'inactive'\n            @recipeState[recipeName].timerID = null\n            return false\n        if(@recipeState[recipeName].status == 'active')\n            if(!@recipeState[recipeName].timerID)\n                #console.log \"Tear down delay for #{recipeName} is \" + @recipeState[recipeName].tearDownDelay\n                if(@recipeState[recipeName].tearDownDelay)\n                    callback = () =>\n                        console.log \"Tear down timed recipe #{recipeName}\"\n                        @executeAction(actionName)\n                        @recipeState[recipeName].status = 'inactive'\n                        @recipeState[recipeName].timerID = null\n                    @recipeState[recipeName].timerID = setTimeout callback, @recipeState[recipeName].tearDownDelay\n                    return true\n                else\n                    console.log \"Tear down non-timed recipe #{recipeName}\"\n                    @recipeState[recipeName].status = 'inactive'\n                    @recipeState[recipeName].timerID = null\n                    @executeAction(actionName)\n                    return true\n            else\n                #console.log \"Tear down timer already triggered for #{recipeName}\"\n                return false\n        else\n            #console.log \"Recipe status is inactive for #{recipeName}\"\n            return false\n        #console.log \"How the fuck did I get in here?\"\n\n    getActiveRecipes: (filter) =>\n        #console.log \"get Active recipes..\"\n        recipeList = []\n        for recipeName, recipeState of @recipeState\n            recipeStatus = recipeState.status\n            #console.log \"recipeName: #{recipeName}, recipeState: #{recipeStatus}\"\n            if(recipeState is 'active')\n                if(typeof filter != 'function' or filter(recipeName))\n                    recipeList.push recipeName\n        return recipeList\n\n# execute action, execute tear down action, set action state active/inactive.. fuuuu\n#\nwindow.ActionController = ActionController\n"]}